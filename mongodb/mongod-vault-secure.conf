# MongoDB Enterprise Security Configuration - VAULT ENABLED
# All TLS certificates retrieved from Vault in real-time

systemLog:
  destination: file
  path: /tmp/mongodb-secure.log
  logAppend: true
  component:
    accessControl:
      verbosity: 2
    network:
      verbosity: 2

storage:
  dbPath: /tmp/mongodb-secure-data
  wiredTiger:
    engineConfig:
      cacheSizeGB: 1

net:
  port: 27017
  bindIp: 127.0.0.1, ::1
  ipv6: true
  # TLS Configuration - Certificates retrieved from Vault
  tls:
    mode: requireTLS
    # These paths will be created by vault-enabled startup script
    certificateKeyFile: /tmp/mongodb-server.pem
    CAFile: /tmp/mongodb-ca.crt
    allowConnectionsWithoutCertificates: false
    allowInvalidCertificates: false
    allowInvalidHostnames: false

# Security - Authentication REQUIRED
security:
  authorization: enabled
  clusterAuthMode: x509

# Process Management  
processManagement:
  pidFilePath: /tmp/mongod-secure.pid

# Operation Profiling for security auditing
operationProfiling:
  slowOpThresholdMs: 100
  mode: slowOp

# Set parameter for security
setParameter:
  authenticationMechanisms: "MONGODB-X509,SCRAM-SHA-256"
  tlsLogVersions: "TLS1_2,TLS1_3"