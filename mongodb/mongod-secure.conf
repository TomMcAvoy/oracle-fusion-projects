# MongoDB Enterprise Security Configuration
# TLS-only connections with authentication required

systemLog:
  destination: file
  path: /usr/local/var/log/mongodb/mongo-secure.log
  logAppend: true
  component:
    accessControl:
      verbosity: 2
    network:
      verbosity: 2

storage:
  dbPath: /usr/local/var/mongodb-secure
  wiredTiger:
    engineConfig:
      cacheSizeGB: 2

net:
  port: 27017
  bindIp: 127.0.0.1, ::1
  ipv6: true
  # TLS Configuration - REQUIRED for all connections
  tls:
    mode: requireTLS
    certificateKeyFile: /Users/thomasmcavoy/GitHub/oracle-fusion-projects/mongodb/tls/mongodb-server.pem
    CAFile: /Users/thomasmcavoy/GitHub/oracle-fusion-projects/mongodb/tls/ca.crt
    allowConnectionsWithoutCertificates: false
    allowInvalidCertificates: false
    allowInvalidHostnames: false

# Security - Authentication REQUIRED
security:
  authorization: enabled
  clusterAuthMode: x509

# Process Management  
processManagement:
  pidFilePath: /usr/local/var/run/mongod-secure.pid

# Operation Profiling for security auditing
operationProfiling:
  slowOpThresholdMs: 100
  mode: slowOp

# Set parameter for security
setParameter:
  authenticationMechanisms: "MONGODB-X509,SCRAM-SHA-256"
  tlsLogVersions: "TLS1_2,TLS1_3"